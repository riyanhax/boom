<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.ys.project.dao.sellingUpdate.SellingUpdateMapper">


	<select id="directPickList" resultType="PartnerVO">
		SELECT * FROM PARTNER
	</select>

	<!-- 상품 인서트 -->
	<insert id="insert" parameterType="ProductionVO">

		INSERT INTO
		PRODUCTION(PRO_NUM,TITLE,PRICE,CONTENT,ADDR,PLACE_PICK,P_QUALITY,CATE_CODE,M_NUM)
		VALUES(production_seq.nextval,#{title},#{price},#{content},#{addr},#{place_pick},#{p_quality},#{cate_code},#{m_num})
		<selectKey keyProperty="pro_num" resultType="int"
			order="AFTER">
			SELECT PRODUCTION_SEQ.CURRVAL FROM DUAL
		</selectKey>

	</insert>

	<!-- 맴버에 대한 상품 리스트 -->
	<select id="getMemberProductionList" parameterType="int"
		resultType="com.ys.project.projectDTO.MemberProductionList">
		<![CDATA[
		SELECT A.PRO_NUM,A.TITLE,A.STATE_MSG,A.PRICE,A.CATE_CODE,D.UUID,D.UPLOADPATH,D.FILENAME
		FROM (SELECT ROWNUM RN,PRO_NUM,TITLE,STATE_MSG,PRICE,CATE_CODE,M_NUM
				FROM PRODUCTION WHERE M_NUM = #{m_num} AND ROWNUM <= 6)A,(
					SELECT *
					FROM PRODUCTION_UPLOAD
					WHERE REP = 1
				) D
		WHERE A.PRO_NUM = D.PRO_NUM AND
		RN > 0
		ORDER BY A.PRO_NUM DESC
		]]>
	</select>

</mapper>